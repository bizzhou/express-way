# INSERT INTO Employee Table
INSERT INTO express_way.Employee (ssn, id, is_manager, start_date, hourly_rate, telephone) VALUES
  ('128484888', '3', FALSE, CURRENT_TIMESTAMP, '30', '5964949999');

# Update Employee Table
UPDATE express_way.Employee
SET hourly_rate = '28'
WHERE id = '3';

#Delete Employee Data
DELETE FROM express_way.Employee
WHERE id = '3';

#Total Fare
SELECT SUM(total_fare)
FROM Reservations
WHERE reservation_date BETWEEN '2011/01/01' AND '2011/01/31';

#Total Booking
SELECT SUM(booking_fee)
FROM Reservations
WHERE reservation_date BETWEEN '2011/01/01' AND '2011/01/31';

############################################




#GET Customer Name
CREATE VIEW full_name AS
  SELECT
    concat(first_name, ' ', last_name),
    id
  FROM Person;

#Get Account ID from Customer Name
# SELECT DISTINCT (account_number)
# FROM full_name, Customer
# WHERE full_name.`concat(first_name, ' ' , last_name)` =  AND full_name.id = Customer.id;

# Get Reservation From Name
SELECT *
FROM Reservations R
WHERE account_number IN
      (SELECT DISTINCT (account_number)
       FROM full_name, Customer
       WHERE full_name.`concat(first_name, ' ' , last_name)` = 'Jane Smith' AND full_name.id = Customer.id)

# Get Reservation From Flights
SELECT *
FROM Reservations
WHERE reservation_number IN
      (SELECT I.reservation_number
       FROM Include I
       WHERE I.flight_number = '111');


############################################################


#Most Active Flight
SELECT *
FROM Flight
ORDER BY date_of_week DESC;



############################################################


# Customer that generates most revenue

#Top Customer and Total Spent
SELECT SUM(total_fare) AS 'total_spend' , C.account_number
FROM Reservations R, Customer C
WHERE R.account_number = C.account_number
GROUP BY C.account_number
ORDER BY total_spend DESC
LIMIT 1;

#Top Customer
SELECT C.account_number
FROM Reservations R, Customer C
WHERE R.account_number = C.account_number
GROUP BY C.account_number
ORDER BY SUM(total_fare) DESC
LIMIT 1;

############################################################

# Employee that generate most revenue;
SELECT E.ssn
FROM Reservations R, Employee E
WHERE R.customer_rep_ssn = E.ssn
GROUP BY E.ssn
ORDER BY SUM(total_fare) DESC
LIMIT 1;


###########################################################


#  Produce a summary listing of revenue generated by a particular flight, destination city, or customer
SELECT * FROM Flight;
SELECT * FROM Include;

SELECT DISTINCT I.reservation_number, total_fare
FROM Include I, Reservations R
WHERE I.flight_number = '111' AND I.airline_id = 'AA' AND R.reservation_number = I.reservation_number


SELECT C.account_number, total_fare
FROM Customer C, Reservations R
WHERE R.account_number = '1000001' AND C.account_number = '1000001';

# TODO Destination City , Check this
SELECT * FROM Legs;

SELECT RS.reservation_number , RS.total_fare FROM Reservations RS WHERE RS.reservation_number IN
  (SELECT DISTINCT I.reservation_number
  FROM Legs L, Reservations R, Include I
  WHERE L.to_airport = 'LAX' AND L.airline_id = I.airline_id AND I.flight_number = L.flight_number
  AND R.reservation_number = I.reservation_number);

###########################################################

# Produce a list of all flights for a given airport
SELECT airline_id, F.flight_number, leg_number, from_airport, to_airport, departure_time, arrival_time, seating_capacity
FROM Legs L, Flight F
WHERE L.flight_number = F.flight_number AND L.from_airport = 'JFK' AND L.airline_id = F.airline;


###########################################################
use express_way;


# TODO check this one??
# Produce a list of all customers who have seats reserved on a given flight
SELECT DISTINCT C.account_number
FROM Flight F, Customer C, Include I, Reservations R
WHERE F.flight_number = '111' AND I.flight_number = F.flight_number AND R.reservation_number = I.reservation_number AND R.account_number = C.account_number

###########################################################

#Produce a list of all flights whose arrival and departure times are on-time/delayed

###########################################################
